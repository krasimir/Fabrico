<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>

<script src="../utils/js/jquery-1.6.3.min.js"></script>
<script src="../utils/js/jquery.snippet.min.js"></script>
<script src="../utils/js/scripts.js" type="text/javascript" language="JavaScript"></script>

<link rel="stylesheet" type="text/css" href="../utils/css/jquery.snippet.min.css">
<link rel="stylesheet" type="text/css" href="../stylesheet.css">
<link rel="stylesheet" type="text/css" href="architecture.css">
<link rel="start" href="../overview-summary.html">

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="PHPDoctor 2RC4 (http://peej.github.com/phpdoctor/)">
<meta name="when" content="Sat, 31 Dec 2011 10:53:14 +0000">
    
<title>Fabrico</title>

</head>
<body id="definition" onload="parent.document.title=document.title;">
<table id="summary_constructor">
    <tr><th colspan="2">Models definition</th></tr>
    <tr>
        <td class="description">
            
<p>
    The models are defined in json files. Normally those files are stored in <strong>/models</strong> directory. The format of the model's json:
</p>
<p>
<pre class="code">
{    
    "adapter": "[path_to_adapter_php]", // example: tools/adapters/MySQL.php
    "freeze": false, // if true the structure of the database will not be checked/changed
    "title": "[string]" // optional,
    "description": "[string]" // optional,
    "fields": [
        <a href="#fields_object">[fields_object]</a>, 
        <a href="#fields_object">[fields_object]</a>, 
        ...
    ],
    "actions": { // optional
        "listing": {
            "fieldsToHide": [
                "[name_of_field]", 
                "[name_of_field]",
                ...
            ],
            "positionEditing": "[up-down|direct]"
        }
    }
}
</pre>
</p>

<a name="fields_object"></a>
<h3>Field object</h3>
<pre class="code">
{
    "name": "[name_of_the_field]", // a database field will be created with the same name
    "presenter": "[path_to_presenter_php]",
    "label": "[label_of_the_field]", // optional
    "config": { // optional
        [configuration_of_the_presenter] // please check the documentation for the specific presenter
    },
    "dependencies": [ // optional
        <a href="#dependency_object">[dependency_object]</a>, 
        <a href="#dependency_object">[dependency_object]</a>, 
        ...
    ],
    "validators": [ // optional
        <a href="#validator_object">[validator_object]</a>, 
        <a href="#validator_object">[validator_object]</a>, 
        ...
    ]
}
</pre>

<a name="dependency_object"></a>
<h3>Dependency object</h3>
<pre class="code">
{
    "field": "[name_of_field]",
    "shouldMatch": "[regular_expression]"
}
</pre>
A complex logic could be added in the dependencies' section. For example:
<pre class="code">
"dependencies": [
    a,
    b
]
</pre>
means: <strong>a && b</strong>. While:
<pre class="code">
"dependencies": [
    a,
    [
        b
    ]
]
</pre>
means: <strong>a || b</strong>.<br />
note that
<pre class="code">
"dependencies": [
    [
        b
    ],
    a
]
</pre>
still means <strong>a && b</strong>.<br />
So, when Fabrico reaches an array it uses <strong>||</strong>, otherwise <strong>&&</strong>.
Few examples:
<pre class="code">
"dependencies": [
    a,
    [
        b,
        c
    ]
]
</pre>
-> <strong>a || (b && c)</strong>
<pre class="code">
"dependencies": [
    a,
    [
        [
            b,
            c
        ],
        [
            d,
            e
        ]        
    ]
]
</pre>
-> <strong>a || ((b && c) || (d && e))</strong>
<pre class="code">
"dependencies": [
    [
        a
    ],
    [
        b     
    ]
]
</pre>
-> <strong>a || b</strong>
<pre class="code">
"dependencies": [
    [
        b,
        [
            c
        ]
    ],
    a
]
</pre>
-> <strong>a && (b || c)</strong>
<a name="validator_object"></a>
<h3>Validator object</h3>
<pre class="code">
{
    "class": "[path_to_validator_php]",
    "parameters": { // optional, please check the specific validator's documentation
        ...
    },
    "method": "run", // optional
    "message": "Wrong input!" // optional
}
</pre>

<br /><br />
<h3>Example:</h3>
<pre class="code">
{    
    "adapter": "tools/adapters/MySQL.php",
    "freeze": false,
    "fields": [
        {
            "name": "question",
            "presenter": "presenters/SelectRadio.php",
            "defaultValue": "maybe",
            "config": {
                "options": [
                    {"key": "yes", "label": "answer Yes"},
                    {"key": "no", "label": "answer No"},
                    {"key": "maybe", "label": "answer Maybe"}
                ]
            }
        },
        {
            "name": "SelectRadio",
            "presenter": "presenters/SelectRadio.php",
            "defaultValue": "option3",
            "config": {
                "options": [
                    {"key": "option1", "label": "option 1"},
                    {"key": "option2", "label": "option 2"},
                    {"key": "option3", "label": "option 3"}
                ]
            }
        },
        {
            "name": "SelectRadio2",
            "presenter": "presenters/SelectRadio.php",
            "defaultValue": "option3",
            "config": {
                "options": [
                    {"key": "option1", "label": "option 1"},
                    {"key": "option2", "label": "option 2"},
                    {"key": "option3", "label": "option 3"}
                ]
            }
        },
        {
            "name": "firstName",
            "presenter": "presenters/Text.php",
            "label": "My first name",
            "validators": [
                {
                    "class": "validators/NotEmpty.php"
                }
            ],
            "dependencies": [
                {
                    "field": "question",
                    "shouldMatch": "^yes$"
                },
                [
                    {
                        "field": "SelectRadio",
                        "shouldMatch": "^option1$"
                    },
                    {
                        "field": "SelectRadio2",
                        "shouldMatch": "^option1$"
                    }
                ]
            ]
        },
        {
            "name": "email",
            "presenter": "presenters/Text.php",
            "label": "your email",
            "validators": [
                {
                    "class": "validators/ValidEmail.php"
                }
            ]
        }
    ],
    "actions": {
        "listing": {
            "fieldsToHide": ["myName"]
        }
    }
}
</pre>

        </td>
    </tr>
</table>
</body>

</html>